include('stdlib.pika');
include('systools.pika');
include(run.root # '../tools/htmlify.pika');

buildHtml = function {
       css = replace(load(run.root # '../tools/docstyle.css'), "\r\n\t", '', find, 1);
       head = "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http://www.w3.org/TR/html4/strict.dtd\">\n<html>\n  <head>\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\n      <meta http-equiv=\"Content-Style-Type\" content=\"text/css\">\n        <title>PikaScript</title>\n    <style type=\"text/css\">\n          table, th, td { border: 1px solid black; padding: 5px; border-collapse:collapse; }\n          th { text-align: left }\n          img { border: 0 none }\n                " # css # "\n        </style>\n  </head>\n          <body>\n";
       tail = "\n        </body>\n</html>\n";
       html = head # htmlify(load($0)) # tail;
       html
};

runTest = function {
    args(@txt);
    html = buildHtml(run.root # txt);
    print(length(html));
};

// runTest('htmlifyPikaDoc.txt');
runTest('test.txt');
runTest('testTrim.txt');
runTest('bulletSpacing.txt');
runTest('bulletSpacingTrim.txt');
runTest('preSpacing.txt');
runTest('preSpacingTrim.txt');
print('OK!');
