include('stdlib.pika');
include('systools.pika');

runTest = function {
    args(@txt);
    path = run.root # txt;
    py = trim(pipe(bake('python3 {quotePath(run.root # "../tools/htmlify.py")} {quotePath(path)}')), void);
    gold = trim(load(run.root # 'golden/' # basenameOfPath(path) # '.html'), void);
    assert(py == gold, 'mismatch for ' # txt);
    print(length(py));
};

runTest('test.txt');
runTest('testTrim.txt');
runTest('bulletSpacing.txt');
runTest('bulletSpacingTrim.txt');
runTest('preSpacing.txt');
runTest('preSpacingTrim.txt');
print('OK!');
